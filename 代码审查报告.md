# PAROL6 é¡¹ç›®ä»£ç å®¡æŸ¥æŠ¥å‘Š

## ğŸ“‹ å®¡æŸ¥æ¦‚è¿°

**å®¡æŸ¥æ—¥æœŸ**: 2024-11-XX
**å®¡æŸ¥èŒƒå›´**: æ•´ä¸ªé¡¹ç›®ä»£ç åº“
**å®¡æŸ¥é‡ç‚¹**: æœªå®Œæˆä»»åŠ¡ã€ä»£ç è´¨é‡ã€å¯ä¼˜åŒ–é¡¹

---

## ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

### 1. æœªå®Œæˆçš„åŠŸèƒ½ï¼ˆTODOï¼‰

#### ğŸ“ ä½ç½®: `Headless/Gemini/robot_vision_tools.py:337`
```python
# TODO: Implement based on your robot's specific kinematics
```

**é—®é¢˜æè¿°**:
- æ–œè§’ï¼ˆangledï¼‰å’Œæ°´å¹³ï¼ˆhorizontalï¼‰æŠ“å–æ–¹å‘çš„æ—‹è½¬è°ƒæ•´æœªå®ç°
- å½“å‰åªå®ç°äº†å‚ç›´ï¼ˆverticalï¼‰æ–¹å‘çš„æ—‹è½¬è°ƒæ•´

**å½±å“**:
- ç”¨æˆ·ä½¿ç”¨éå‚ç›´æŠ“å–æ–¹å¼æ—¶å¯èƒ½å‡ºç°å§¿æ€ä¸æ­£ç¡®
- é™åˆ¶äº†æŠ“å–çš„çµæ´»æ€§

**å»ºè®®ä¿®å¤**:
```python
elif approach_angle == "angled":
    # 45åº¦è§’æŠ“å–éœ€è¦è°ƒæ•´ä¿¯ä»°è§’
    adjusted_orientation = optimal_orientation.copy()
    adjusted_orientation[1] = 45  # è®¾ç½®ä¿¯ä»°è§’ä¸º45åº¦

    # æ ¹æ®ç‰©ä½“æœå‘è°ƒæ•´æ—‹è½¬
    while adjusted_orientation[0] > 180:
        adjusted_orientation[0] -= 360
    while adjusted_orientation[0] < -180:
        adjusted_orientation[0] += 360

else:  # horizontal
    # æ°´å¹³æŠ“å–éœ€è¦è°ƒæ•´ä¿¯ä»°è§’ä¸º0æˆ–90åº¦
    adjusted_orientation = optimal_orientation.copy()
    adjusted_orientation[1] = 0  # ä¿¯ä»°è§’ä¸º0ï¼ˆæ°´å¹³ï¼‰

    # å¯èƒ½éœ€è¦è°ƒæ•´æ»šè½¬è§’ä»¥é€‚åº”å¤¹çˆªæ–¹å‘
    adjusted_orientation[2] = 0  # æ»šè½¬è§’å½’é›¶
```

**ä¼˜å…ˆçº§**: â­â­â­â­ é«˜
**é¢„è®¡å·¥ä½œé‡**: 2-4 å°æ—¶

---

### 2. ä¸å®‰å…¨çš„å¼‚å¸¸å¤„ç†ï¼ˆBare Exceptï¼‰

å‘ç° **10 å¤„** ä½¿ç”¨äº† `except:` è€Œä¸æ˜¯å…·ä½“çš„å¼‚å¸¸ç±»å‹ã€‚

#### ğŸ“ ä½ç½®åˆ—è¡¨:
1. `Headless/headless_commander.py:2678`
2. `Headless/headless_commander.py:3242`
3. `Headless/Gemini/gemini.py:1169`
4. `Headless/Gemini/gemini.py:1178`
5. `Headless/Gemini/gemini.py:1184`
6. `Headless/Gemini/robot_vision_tools.py:618`
7. `Headless/Vision/calibration_refinement.py:179`
8. `Headless/Vision/calibration_refinement.py:183`
9. `Headless/Vision/calibration_refinement.py:477`
10. `Headless/Vision/calibration_refinement.py:1241`

**é—®é¢˜æè¿°**:
- Bare except ä¼šæ•è·æ‰€æœ‰å¼‚å¸¸ï¼ŒåŒ…æ‹¬ `KeyboardInterrupt` å’Œ `SystemExit`
- éšè—çœŸå®çš„é”™è¯¯ä¿¡æ¯ï¼Œå¯¼è‡´è°ƒè¯•å›°éš¾
- è¿å Python æœ€ä½³å®è·µï¼ˆPEP 8ï¼‰

**å»ºè®®ä¿®å¤æ¨¡å¼**:
```python
# âŒ ä¸å¥½çš„åšæ³•
try:
    risky_operation()
except:
    pass

# âœ… å¥½çš„åšæ³•
try:
    risky_operation()
except (ValueError, TypeError, IOError) as e:
    logger.error(f"Operation failed: {e}")
    # é€‚å½“çš„é”™è¯¯å¤„ç†
```

**ä¼˜å…ˆçº§**: â­â­â­â­â­ ç´§æ€¥
**é¢„è®¡å·¥ä½œé‡**: 3-5 å°æ—¶ï¼ˆéœ€è¦é€ä¸ªåˆ†æä¸Šä¸‹æ–‡ï¼‰

---

### 3. ç¼ºå°‘ä¾èµ–ç®¡ç†æ–‡ä»¶

**é—®é¢˜æè¿°**:
- æ²¡æœ‰ `requirements.txt` æ–‡ä»¶
- `pyproject.toml` é…ç½®è¿‡äºç®€å•ï¼Œç¼ºå°‘ä¾èµ–å®šä¹‰
- æ–°ç”¨æˆ·éš¾ä»¥å¿«é€Ÿå®‰è£…æ‰€æœ‰ä¾èµ–

**å½“å‰ pyproject.toml**:
```toml
[project]
name = "my_project"  # â† é¡¹ç›®åç§°ä¹Ÿæ˜¯å ä½ç¬¦
version = "0.1.0"

[tool.setuptools]
packages = ["Headless"]
```

**å»ºè®®åˆ›å»º `requirements.txt`**:
```txt
# æ ¸å¿ƒä¾èµ–
roboticstoolbox-python==1.0.3
numpy==1.23.4
scipy==1.11.4
spatialmath
pyserial
oclock
keyboard

# è§†è§‰ä¾èµ–
opencv-python>=4.8.0
pyrealsense2>=2.54.0
Pillow>=10.0.0

# AI ä¾èµ–
google-genai>=0.3.0
python-dotenv>=1.0.0
pyaudio>=0.2.13

# å¯é€‰ä¾èµ–
jupyter>=1.0.0
matplotlib>=3.7.0
```

**å»ºè®®æ›´æ–° `pyproject.toml`**:
```toml
[project]
name = "parol6-gemini-vision"
version = "1.0.0"
description = "PAROL6 Robotic Arm with Gemini Vision AI Control"
authors = [{name = "Your Name", email = "your.email@example.com"}]
readme = "README_CN.md"
requires-python = ">=3.8"
license = {text = "MIT"}

dependencies = [
    "roboticstoolbox-python==1.0.3",
    "numpy==1.23.4",
    "scipy==1.11.4",
    "spatialmath",
    "pyserial",
    "oclock",
    "keyboard",
]

[project.optional-dependencies]
vision = [
    "opencv-python>=4.8.0",
    "pyrealsense2>=2.54.0",
    "Pillow>=10.0.0",
]
ai = [
    "google-genai>=0.3.0",
    "python-dotenv>=1.0.0",
    "pyaudio>=0.2.13",
]
dev = [
    "jupyter>=1.0.0",
    "matplotlib>=3.7.0",
    "pytest>=7.0.0",
]

[tool.setuptools]
packages = ["Headless"]
```

**ä¼˜å…ˆçº§**: â­â­â­â­ é«˜
**é¢„è®¡å·¥ä½œé‡**: 1-2 å°æ—¶

---

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

### 4. é…ç½®ç¡¬ç¼–ç 

**é—®é¢˜æè¿°**:
è®¸å¤šé…ç½®å‚æ•°ç›´æ¥ç¡¬ç¼–ç åœ¨ä»£ç ä¸­ï¼Œéš¾ä»¥ä¿®æ”¹å’Œç®¡ç†ã€‚

#### ğŸ“ å‘ç°çš„ç¡¬ç¼–ç å€¼:

**robot_vision_tools.py**:
```python
APPROACH_HEIGHT = 50  # mm
GRASP_HEIGHT = 100
PLACE_OFFSET = 10
DEFAULT_GRIPPER_ORIENTATION = [90, 180, 0]
GRIPPER_OPEN_POS = 0
GRIPPER_CLOSE_POS = 255
GRIPPER_SPEED = 60
GRIPPER_CURRENT = 600
SPEED_APPROACH = 40
SPEED_GRASP = 20
SPEED_LIFT = 50
```

**vision_controller.py**:
```python
CAMERA_WIDTH = 640
CAMERA_HEIGHT = 480
CAMERA_FPS = 30
ROBOT_MAX_REACH_MM = 400
ROBOT_MIN_REACH_MM = 100
DEPTH_FILTER_SIZE = 5
MIN_VALID_DEPTH_RATIO = 0.2
```

**robot_api.py** (æ¨æµ‹):
```python
SERVER_IP = "127.0.0.1"
SERVER_PORT = 5001
```

**å»ºè®®è§£å†³æ–¹æ¡ˆ**:

åˆ›å»º `Headless/config.yaml`:
```yaml
# æœºå™¨äººé…ç½®
robot:
  max_reach_mm: 400
  min_reach_mm: 100
  workspace_height_max: 300
  workspace_height_min: -50

# è¿åŠ¨å‚æ•°
motion:
  approach_height: 50
  grasp_height: 100
  place_offset: 10
  speed:
    approach: 40
    grasp: 20
    lift: 50
    transport: 50

# å¤¹çˆªé…ç½®
gripper:
  type: "electric"  # or "pneumatic"
  electric:
    open_position: 0
    close_position: 255
    default_speed: 60
    default_current: 600
  pneumatic:
    port: 1

# ç›¸æœºé…ç½®
camera:
  width: 640
  height: 480
  fps: 30
  depth_filter_size: 5
  min_valid_depth_ratio: 0.2

# ç½‘ç»œé…ç½®
network:
  server_ip: "127.0.0.1"
  server_port: 5001
  client_port: 5002

# Gemini é…ç½®
gemini:
  model: "gemini-2.5-flash-live-preview"
  enable_debug: true
  snapshot_interval: 1.0
```

åˆ›å»ºé…ç½®åŠ è½½æ¨¡å— `Headless/config_loader.py`:
```python
import yaml
import os
from typing import Dict, Any

class Config:
    def __init__(self, config_path: str = None):
        if config_path is None:
            config_path = os.path.join(
                os.path.dirname(__file__),
                'config.yaml'
            )

        with open(config_path, 'r', encoding='utf-8') as f:
            self._config = yaml.safe_load(f)

    def get(self, key: str, default: Any = None) -> Any:
        """è·å–é…ç½®å€¼ï¼Œæ”¯æŒç‚¹å·åˆ†éš”çš„è·¯å¾„"""
        keys = key.split('.')
        value = self._config

        for k in keys:
            if isinstance(value, dict) and k in value:
                value = value[k]
            else:
                return default

        return value

# å…¨å±€é…ç½®å®ä¾‹
config = Config()
```

ä½¿ç”¨æ–¹å¼:
```python
from config_loader import config

APPROACH_HEIGHT = config.get('motion.approach_height', 50)
CAMERA_WIDTH = config.get('camera.width', 640)
```

**ä¼˜å…ˆçº§**: â­â­â­ ä¸­
**é¢„è®¡å·¥ä½œé‡**: 4-6 å°æ—¶

---

### 5. ç¼ºå°‘å•å…ƒæµ‹è¯•

**é—®é¢˜æè¿°**:
- é¡¹ç›®ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æµ‹è¯•æ–‡ä»¶ï¼ˆ`test_*.py` æˆ– `*_test.py`ï¼‰
- ç¼ºå°‘è‡ªåŠ¨åŒ–æµ‹è¯•å¯èƒ½å¯¼è‡´é‡æ„æˆ–ä¿®æ”¹æ—¶å¼•å…¥ bug
- éš¾ä»¥éªŒè¯æ ¸å¿ƒåŠŸèƒ½çš„æ­£ç¡®æ€§

**å»ºè®®æ·»åŠ æµ‹è¯•**:

åˆ›å»º `Headless/tests/` ç›®å½•ç»“æ„:
```
Headless/tests/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ test_robot_api.py
â”œâ”€â”€ test_vision_controller.py
â”œâ”€â”€ test_kinematics.py
â””â”€â”€ test_gripper_control.py
```

ç¤ºä¾‹æµ‹è¯• `test_robot_api.py`:
```python
import pytest
from unittest.mock import Mock, patch
from robot_api import move_robot_joints, get_robot_pose

class TestRobotAPI:
    @patch('robot_api.socket')
    def test_move_robot_joints_valid_input(self, mock_socket):
        """æµ‹è¯•å…³èŠ‚è¿åŠ¨å‡½æ•°æ¥å—æœ‰æ•ˆè¾“å…¥"""
        angles = [0, -90, 180, 0, 0, 180]
        result = move_robot_joints(angles, duration=5.0)
        assert result is not None

    def test_move_robot_joints_invalid_angles(self):
        """æµ‹è¯•å…³èŠ‚è¿åŠ¨å‡½æ•°æ‹’ç»æ— æ•ˆè§’åº¦"""
        # åªæœ‰5ä¸ªè§’åº¦ï¼ˆåº”è¯¥æ˜¯6ä¸ªï¼‰
        with pytest.raises(ValueError):
            move_robot_joints([0, -90, 180, 0, 0], duration=5.0)

    @patch('robot_api.socket')
    def test_get_robot_pose(self, mock_socket):
        """æµ‹è¯•è·å–æœºå™¨äººä½ç½®"""
        # æ¨¡æ‹Ÿè¿”å›æ•°æ®
        mock_socket.return_value.recv.return_value = b"200.0,0.0,150.0,180.0,0.0,0.0"

        pose = get_robot_pose()
        assert len(pose) == 6
        assert pose[0] == 200.0
```

é…ç½® `pytest.ini`:
```ini
[pytest]
testpaths = Headless/tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
```

æ·»åŠ åˆ° `requirements-dev.txt`:
```txt
pytest>=7.4.0
pytest-cov>=4.1.0
pytest-mock>=3.11.0
```

**ä¼˜å…ˆçº§**: â­â­â­ ä¸­
**é¢„è®¡å·¥ä½œé‡**: 8-12 å°æ—¶ï¼ˆåˆå§‹æµ‹è¯•å¥—ä»¶ï¼‰

---

### 6. æ—¥å¿—ç³»ç»Ÿä¸ç»Ÿä¸€

**é—®é¢˜æè¿°**:
- éƒ¨åˆ†æ–‡ä»¶ä½¿ç”¨ `logging` æ¨¡å—
- éƒ¨åˆ†æ–‡ä»¶ä½¿ç”¨ `print()` è¯­å¥
- ç¼ºå°‘ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼å’Œçº§åˆ«æ§åˆ¶

**å»ºè®®è§£å†³æ–¹æ¡ˆ**:

åˆ›å»º `Headless/logger.py`:
```python
import logging
import sys
from typing import Optional

def setup_logger(
    name: str,
    level: int = logging.INFO,
    log_file: Optional[str] = None
) -> logging.Logger:
    """è®¾ç½®ç»Ÿä¸€çš„æ—¥å¿—å™¨

    Args:
        name: æ—¥å¿—å™¨åç§°
        level: æ—¥å¿—çº§åˆ«
        log_file: æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰

    Returns:
        é…ç½®å¥½çš„æ—¥å¿—å™¨
    """
    logger = logging.getLogger(name)
    logger.setLevel(level)

    # æ§åˆ¶å°å¤„ç†å™¨
    console_handler = logging.StreamHandler(sys.stdout)
    console_handler.setLevel(level)

    # æ ¼å¼åŒ–å™¨
    formatter = logging.Formatter(
        '[%(asctime)s] %(name)s - %(levelname)s - %(message)s',
        datefmt='%Y-%m-%d %H:%M:%S'
    )
    console_handler.setFormatter(formatter)

    logger.addHandler(console_handler)

    # æ–‡ä»¶å¤„ç†å™¨ï¼ˆå¯é€‰ï¼‰
    if log_file:
        file_handler = logging.FileHandler(log_file, encoding='utf-8')
        file_handler.setLevel(level)
        file_handler.setFormatter(formatter)
        logger.addHandler(file_handler)

    return logger

# åˆ›å»ºé»˜è®¤æ—¥å¿—å™¨
default_logger = setup_logger('PAROL6')
```

ä½¿ç”¨æ–¹å¼:
```python
from logger import setup_logger

logger = setup_logger(__name__)

# æ›¿æ¢ print() ä¸ºæ—¥å¿—
# print("Starting robot...")
logger.info("Starting robot...")

# print(f"Error: {e}")
logger.error(f"Operation failed: {e}")

# è°ƒè¯•ä¿¡æ¯
logger.debug(f"Current position: {pose}")
```

**ä¼˜å…ˆçº§**: â­â­â­ ä¸­
**é¢„è®¡å·¥ä½œé‡**: 3-4 å°æ—¶

---

## ğŸŸ¢ ä½ä¼˜å…ˆçº§ä¼˜åŒ–

### 7. ä»£ç é‡å¤

**é—®é¢˜æè¿°**:
å‘ç°å¤šå¤„ç±»ä¼¼çš„ä»£ç æ¨¡å¼å¯ä»¥æå–ä¸ºå…¬å…±å‡½æ•°ã€‚

#### ç¤ºä¾‹ 1: ä½ç½®éªŒè¯

å¤šä¸ªæ–‡ä»¶ä¸­é‡å¤éªŒè¯ä½ç½®æ˜¯å¦å¯è¾¾ï¼š
```python
# åœ¨å¤šä¸ªåœ°æ–¹é‡å¤å‡ºç°
if abs(x) > 400 or abs(y) > 400:
    raise ValueError("Position out of reach")
```

**å»ºè®®**: åˆ›å»ºå…¬å…±éªŒè¯å‡½æ•°
```python
# Headless/utils/validators.py
def validate_position(x: float, y: float, z: float,
                     max_reach: float = 400,
                     min_reach: float = 100) -> bool:
    """éªŒè¯ä½ç½®æ˜¯å¦åœ¨å·¥ä½œç©ºé—´å†…"""
    distance = (x**2 + y**2)**0.5
    if distance > max_reach or distance < min_reach:
        raise ValueError(
            f"Position ({x}, {y}, {z}) out of reach. "
            f"Distance: {distance:.1f}mm (range: {min_reach}-{max_reach}mm)"
        )
    if not (-50 <= z <= 300):
        raise ValueError(f"Z position {z}mm out of range (-50 to 300mm)")
    return True
```

#### ç¤ºä¾‹ 2: è§’åº¦å½’ä¸€åŒ–

```python
# é‡å¤å‡ºç°çš„è§’åº¦å½’ä¸€åŒ–ä»£ç 
while angle > 180:
    angle -= 360
while angle < -180:
    angle += 360
```

**å»ºè®®**: åˆ›å»ºå·¥å…·å‡½æ•°
```python
# Headless/utils/math_utils.py
def normalize_angle(angle: float) -> float:
    """å°†è§’åº¦å½’ä¸€åŒ–åˆ° [-180, 180] èŒƒå›´"""
    angle = angle % 360
    if angle > 180:
        angle -= 360
    return angle
```

**ä¼˜å…ˆçº§**: â­â­ ä½
**é¢„è®¡å·¥ä½œé‡**: 2-3 å°æ—¶

---

### 8. ç¼ºå°‘ç±»å‹æç¤º

**é—®é¢˜æè¿°**:
- è®¸å¤šå‡½æ•°ç¼ºå°‘ç±»å‹æç¤ºï¼ˆType Hintsï¼‰
- é™ä½ä»£ç å¯è¯»æ€§å’Œ IDE æ”¯æŒ
- éš¾ä»¥å‘ç°ç±»å‹ç›¸å…³çš„ bug

**ç¤ºä¾‹æ”¹è¿›**:

```python
# âŒ æ²¡æœ‰ç±»å‹æç¤º
def move_robot_joints(angles, duration=None, speed=None):
    pass

# âœ… æœ‰ç±»å‹æç¤º
from typing import List, Optional, Dict, Any

def move_robot_joints(
    angles: List[float],
    duration: Optional[float] = None,
    speed: Optional[int] = None,
    wait_for_ack: bool = False,
    timeout: float = 2.0
) -> Optional[Dict[str, Any]]:
    """ç§»åŠ¨æœºå™¨äººå…³èŠ‚åˆ°æŒ‡å®šè§’åº¦

    Args:
        angles: 6ä¸ªå…³èŠ‚çš„ç›®æ ‡è§’åº¦ï¼ˆåº¦ï¼‰
        duration: è¿åŠ¨æ—¶é•¿ï¼ˆç§’ï¼‰ï¼Œä¸ speed äº’æ–¥
        speed: é€Ÿåº¦ç™¾åˆ†æ¯” (0-100)ï¼Œä¸ duration äº’æ–¥
        wait_for_ack: æ˜¯å¦ç­‰å¾…ç¡®è®¤
        timeout: è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰

    Returns:
        å¦‚æœ wait_for_ack=Trueï¼Œè¿”å›çŠ¶æ€å­—å…¸ï¼›å¦åˆ™è¿”å› None

    Raises:
        ValueError: å¦‚æœè§’åº¦æ•°é‡ä¸æ˜¯6ä¸ªæˆ–å‚æ•°æ— æ•ˆ
        TimeoutError: å¦‚æœç­‰å¾…ç¡®è®¤è¶…æ—¶
    """
    pass
```

**ä¼˜å…ˆçº§**: â­â­ ä½
**é¢„è®¡å·¥ä½œé‡**: 6-8 å°æ—¶ï¼ˆå…¨é¡¹ç›®ï¼‰

---

### 9. æ–‡æ¡£å­—ç¬¦ä¸²ä¸å®Œæ•´

**é—®é¢˜æè¿°**:
- éƒ¨åˆ†å‡½æ•°ç¼ºå°‘æ–‡æ¡£å­—ç¬¦ä¸²
- ç°æœ‰æ–‡æ¡£å­—ç¬¦ä¸²æ ¼å¼ä¸ç»Ÿä¸€
- ç¼ºå°‘å‚æ•°è¯´æ˜å’Œè¿”å›å€¼è¯´æ˜

**å»ºè®®**: ä½¿ç”¨ Google é£æ ¼æˆ– NumPy é£æ ¼æ–‡æ¡£å­—ç¬¦ä¸²

```python
def smooth_circle(
    center: List[float],
    radius: float,
    plane: str = 'XY',
    duration: Optional[float] = None,
    speed_percentage: Optional[float] = None,
    clockwise: bool = False,
    wait_for_ack: bool = False,
    timeout: float = 10.0
) -> Optional[Dict[str, Any]]:
    """åœ¨æŒ‡å®šå¹³é¢æ‰§è¡Œåœ†å½¢è½¨è¿¹è¿åŠ¨

    æœºå™¨äººæœ«ç«¯å°†æ²¿ç€åœ†å½¢è·¯å¾„è¿åŠ¨ï¼Œä¿æŒæ’å®šçš„é€Ÿåº¦ã€‚

    Args:
        center: åœ†å¿ƒåæ ‡ [x, y, z] (mm)
        radius: åœ†çš„åŠå¾„ (mm)
        plane: åœ†æ‰€åœ¨çš„å¹³é¢ï¼Œå¯é€‰ 'XY', 'XZ', 'YZ'
        duration: å®Œæˆåœ†å½¢è½¨è¿¹çš„æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œä¸ speed_percentage äº’æ–¥
        speed_percentage: é€Ÿåº¦ç™¾åˆ†æ¯” (1-100)ï¼Œä¸ duration äº’æ–¥
        clockwise: æ˜¯å¦é¡ºæ—¶é’ˆæ–¹å‘ï¼Œé»˜è®¤ä¸ºé€†æ—¶é’ˆ
        wait_for_ack: æ˜¯å¦ç­‰å¾…è¿åŠ¨å®Œæˆçš„ç¡®è®¤
        timeout: ç­‰å¾…ç¡®è®¤çš„è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰

    Returns:
        å¦‚æœ wait_for_ack=Trueï¼Œè¿”å›åŒ…å«ä»¥ä¸‹é”®çš„å­—å…¸ï¼š
            - status: è¿åŠ¨çŠ¶æ€ ('COMPLETED', 'FAILED', etc.)
            - details: è¯¦ç»†ä¿¡æ¯
            - completed: æ˜¯å¦å®Œæˆ
        å¦‚æœ wait_for_ack=Falseï¼Œè¿”å› None

    Raises:
        ValueError: å¦‚æœå‚æ•°æ— æ•ˆæˆ–åœ†å¿ƒ/åŠå¾„è¶…å‡ºå·¥ä½œç©ºé—´
        RuntimeError: å¦‚æœè¿åŠ¨æ‰§è¡Œå¤±è´¥

    Example:
        >>> # åœ¨XYå¹³é¢ç”»ä¸€ä¸ªåŠå¾„50mmçš„åœ†ï¼Œç”¨æ—¶8ç§’
        >>> smooth_circle(
        ...     center=[220, 0, 180],
        ...     radius=50,
        ...     plane='XY',
        ...     duration=8.0
        ... )

    Note:
        - åœ†å½¢è½¨è¿¹ä¼šè‡ªåŠ¨ä»å½“å‰ä½ç½®å¼€å§‹
        - å¦‚æœå½“å‰ä½ç½®ä¸åœ¨åœ†ä¸Šï¼Œä¼šå…ˆç§»åŠ¨åˆ°æœ€è¿‘çš„åœ†ä¸Šçš„ç‚¹
        - è¿åŠ¨è¿‡ç¨‹ä¸­ä¼šä¿æŒæœ«ç«¯å§¿æ€ä¸å˜
    """
    pass
```

**ä¼˜å…ˆçº§**: â­â­ ä½
**é¢„è®¡å·¥ä½œé‡**: 8-10 å°æ—¶

---

### 10. æ€§èƒ½ä¼˜åŒ–æœºä¼š

**é—®é¢˜æè¿°**:
å‘ç°ä¸€äº›å¯ä»¥ä¼˜åŒ–æ€§èƒ½çš„åœ°æ–¹ã€‚

#### 10.1 é‡å¤çš„æ•°å­¦è®¡ç®—

```python
# âŒ æ¯æ¬¡å¾ªç¯éƒ½è®¡ç®—
for i in range(100):
    distance = math.sqrt(x**2 + y**2 + z**2)
    if distance < threshold:
        # ...

# âœ… ä¼˜åŒ–å
threshold_squared = threshold ** 2
for i in range(100):
    distance_squared = x**2 + y**2 + z**2
    if distance_squared < threshold_squared:
        # ...
```

#### 10.2 ä¸å¿…è¦çš„åˆ—è¡¨å¤åˆ¶

```python
# âŒ åˆ›å»ºä¸å¿…è¦çš„å‰¯æœ¬
def process_trajectory(points):
    new_points = points.copy()
    # åªè¯»æ“ä½œ
    for p in new_points:
        print(p)

# âœ… ç›´æ¥ä½¿ç”¨
def process_trajectory(points):
    for p in points:
        print(p)
```

#### 10.3 ä½¿ç”¨ NumPy ä¼˜åŒ–å‘é‡è¿ç®—

```python
# âŒ Python å¾ªç¯
total = 0
for i in range(len(values)):
    total += values[i] * weights[i]

# âœ… NumPy å‘é‡åŒ–
import numpy as np
total = np.dot(values, weights)
```

**ä¼˜å…ˆçº§**: â­ å¾ˆä½
**é¢„è®¡å·¥ä½œé‡**: éœ€è¦æ€§èƒ½åˆ†æåç¡®å®š

---

## ğŸ“ˆ ä¼˜åŒ–å»ºè®®ä¼˜å…ˆçº§æ€»ç»“

### ğŸ”´ ç´§æ€¥ï¼ˆå»ºè®®ç«‹å³å¤„ç†ï¼‰
1. â­â­â­â­â­ **ä¿®å¤ Bare Except** - å½±å“ç¨³å®šæ€§å’Œè°ƒè¯•
   - é¢„è®¡: 3-5 å°æ—¶
   - å½±å“: é«˜

### ğŸŸ  é«˜ä¼˜å…ˆçº§ï¼ˆå»ºè®®å°½å¿«å¤„ç†ï¼‰
2. â­â­â­â­ **å®Œæˆ TODO åŠŸèƒ½** - å½±å“åŠŸèƒ½å®Œæ•´æ€§
   - é¢„è®¡: 2-4 å°æ—¶
   - å½±å“: ä¸­-é«˜

3. â­â­â­â­ **æ·»åŠ ä¾èµ–ç®¡ç†æ–‡ä»¶** - å½±å“ç”¨æˆ·ä½“éªŒ
   - é¢„è®¡: 1-2 å°æ—¶
   - å½±å“: é«˜

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆå»ºè®®è¿‘æœŸå¤„ç†ï¼‰
4. â­â­â­ **é…ç½®æ–‡ä»¶åŒ–** - æé«˜å¯ç»´æŠ¤æ€§
   - é¢„è®¡: 4-6 å°æ—¶
   - å½±å“: ä¸­

5. â­â­â­ **ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ** - æé«˜è°ƒè¯•æ•ˆç‡
   - é¢„è®¡: 3-4 å°æ—¶
   - å½±å“: ä¸­

6. â­â­â­ **æ·»åŠ å•å…ƒæµ‹è¯•** - æé«˜ä»£ç è´¨é‡
   - é¢„è®¡: 8-12 å°æ—¶
   - å½±å“: ä¸­-é«˜ï¼ˆé•¿æœŸï¼‰

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆå¯ä»¥å»¶åå¤„ç†ï¼‰
7. â­â­ **å‡å°‘ä»£ç é‡å¤** - ä»£ç ä¼˜åŒ–
   - é¢„è®¡: 2-3 å°æ—¶
   - å½±å“: ä½

8. â­â­ **æ·»åŠ ç±»å‹æç¤º** - æé«˜ä»£ç è´¨é‡
   - é¢„è®¡: 6-8 å°æ—¶
   - å½±å“: ä½-ä¸­

9. â­â­ **å®Œå–„æ–‡æ¡£å­—ç¬¦ä¸²** - æé«˜å¯è¯»æ€§
   - é¢„è®¡: 8-10 å°æ—¶
   - å½±å“: ä½

10. â­ **æ€§èƒ½ä¼˜åŒ–** - éœ€è¦å…ˆè¿›è¡Œæ€§èƒ½åˆ†æ
    - é¢„è®¡: TBD
    - å½±å“: ä½

---

## ğŸ¯ å»ºè®®çš„å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼ˆæœ¬å‘¨ï¼‰- ç´§æ€¥ä¿®å¤
- [ ] ä¿®å¤æ‰€æœ‰ Bare Except è¯­å¥
- [ ] åˆ›å»º requirements.txt
- [ ] æ›´æ–° pyproject.toml

**é¢„è®¡æ—¶é—´**: 5-7 å°æ—¶
**æ•ˆæœ**: ç«‹å³æå‡ä»£ç è´¨é‡å’Œç”¨æˆ·ä½“éªŒ

### ç¬¬äºŒé˜¶æ®µï¼ˆä¸‹å‘¨ï¼‰- åŠŸèƒ½å®Œå–„
- [ ] å®Œæˆ robot_vision_tools.py ä¸­çš„ TODO
- [ ] åˆ›å»ºé…ç½®æ–‡ä»¶ç³»ç»Ÿ
- [ ] ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ

**é¢„è®¡æ—¶é—´**: 9-14 å°æ—¶
**æ•ˆæœ**: æé«˜åŠŸèƒ½å®Œæ•´æ€§å’Œå¯ç»´æŠ¤æ€§

### ç¬¬ä¸‰é˜¶æ®µï¼ˆåç»­ï¼‰- è´¨é‡æå‡
- [ ] æ·»åŠ åŸºç¡€å•å…ƒæµ‹è¯•ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
- [ ] æ·»åŠ ç±»å‹æç¤ºï¼ˆä¸»è¦APIï¼‰
- [ ] å‡å°‘ä»£ç é‡å¤
- [ ] å®Œå–„æ–‡æ¡£å­—ç¬¦ä¸²

**é¢„è®¡æ—¶é—´**: 16-23 å°æ—¶
**æ•ˆæœ**: é•¿æœŸä»£ç è´¨é‡ä¿è¯

### ç¬¬å››é˜¶æ®µï¼ˆæŒç»­ï¼‰- ä¼˜åŒ–æ”¹è¿›
- [ ] æ€§èƒ½åˆ†æå’Œä¼˜åŒ–
- [ ] æ‰©å±•æµ‹è¯•è¦†ç›–ç‡
- [ ] ä»£ç é‡æ„

**é¢„è®¡æ—¶é—´**: æŒç»­è¿›è¡Œ
**æ•ˆæœ**: æŒç»­æ”¹è¿›

---

## ğŸ” é¢å¤–å‘ç°

### å¥½çš„å®è·µ
âœ… ä½¿ç”¨äº† logging æ¨¡å—ï¼ˆéƒ¨åˆ†æ–‡ä»¶ï¼‰
âœ… æœ‰è¯¦ç»†çš„ä¸­æ–‡æ–‡æ¡£
âœ… ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ¨¡å—åŒ–è‰¯å¥½
âœ… æœ‰å®‰å…¨æ£€æŸ¥ï¼ˆæ€¥åœç›‘æ§ã€é™ä½æ£€æŸ¥ï¼‰
âœ… æœ‰é”™è¯¯å¤„ç†ï¼ˆå¤§éƒ¨åˆ†æƒ…å†µï¼‰

### æ½œåœ¨é£é™©
âš ï¸ ç½‘ç»œé€šä¿¡æ— åŠ å¯†ï¼ˆUDPæ˜æ–‡ï¼‰
âš ï¸ æ— ç”¨æˆ·è®¤è¯æœºåˆ¶
âš ï¸ ç¼ºå°‘è¾“å…¥éªŒè¯ï¼ˆéƒ¨åˆ†APIï¼‰
âš ï¸ ç¡¬ç¼–ç çš„é»˜è®¤å€¼å¯èƒ½ä¸é€‚åˆæ‰€æœ‰ç”¨æˆ·

---

## ğŸ“ ç»“è®º

é¡¹ç›®æ•´ä½“ä»£ç è´¨é‡**è‰¯å¥½**ï¼Œä½†å­˜åœ¨ä¸€äº›éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼š

**ä¼˜ç‚¹**:
- åŠŸèƒ½å®Œæ•´ï¼Œæ¶æ„æ¸…æ™°
- æ–‡æ¡£è¯¦ç»†ï¼ˆç‰¹åˆ«æ˜¯ä¸­æ–‡æ–‡æ¡£ï¼‰
- æœ‰åŸºæœ¬çš„é”™è¯¯å¤„ç†å’Œå®‰å…¨æ£€æŸ¥

**éœ€è¦æ”¹è¿›**:
- å¼‚å¸¸å¤„ç†ä¸å¤Ÿè§„èŒƒï¼ˆBare Exceptï¼‰
- ç¼ºå°‘æµ‹è¯•å’Œä¾èµ–ç®¡ç†
- é…ç½®ç¡¬ç¼–ç ï¼Œä¸å¤Ÿçµæ´»
- éƒ¨åˆ†åŠŸèƒ½æœªå®Œæˆï¼ˆTODOï¼‰

**æ€»ä½“è¯„åˆ†**: â­â­â­â­ (4/5)

**å»ºè®®**: ä¼˜å…ˆå¤„ç†ç´§æ€¥å’Œé«˜ä¼˜å…ˆçº§é—®é¢˜ï¼Œå¯ä»¥æ˜¾è‘—æå‡é¡¹ç›®çš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2024-11-XX
**å®¡æŸ¥äºº**: Claude AI Assistant
**ä¸‹æ¬¡å®¡æŸ¥å»ºè®®**: å®Œæˆç¬¬ä¸€é˜¶æ®µä¼˜åŒ–å
