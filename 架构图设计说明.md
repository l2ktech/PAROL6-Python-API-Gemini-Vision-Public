# PAROL6 项目架构图设计说明

## 📐 架构图概览

**文件名**: `PAROL6项目架构图.drawio`
**尺寸**: 1920 × 1200 像素
**层次**: 5 层架构 + 图例
**模块数**: 30+ 个详细模块

---

## 🎨 配色方案

### 技术感配色设计原则

采用 **Material Design** 色系，提供清晰的视觉层次和专业的技术感。

### 各层配色详情

#### 🔵 第 1 层：用户交互层
- **主色**: `#E3F2FD` (Light Blue 50)
- **边框**: `#1976D2` (Blue 700)
- **模块填充**: `#BBDEFB` (Light Blue 200)
- **文字颜色**: `#0D47A1` (Blue 900)

**设计理念**:
- 蓝色代表科技、通信和交互
- 浅蓝色背景温和不刺眼
- 深蓝色文字确保可读性

#### 🔮 第 2 层：AI 处理层
- **主色**: `#E8EAF6` (Deep Purple 50)
- **边框**: `#5E35B1` (Deep Purple 600)
- **模块填充**: `#D1C4E9` (Deep Purple 200)
- **文字颜色**: `#311B92` (Deep Purple 900)

**设计理念**:
- 紫色代表智能、神秘和高级
- 体现 AI 的创新性
- 与其他层明显区分

#### 💎 第 3 层：视觉处理层
- **主色**: `#E0F2F1` (Teal 50)
- **边框**: `#00897B` (Teal 600)
- **模块填充**: `#B2DFDB` (Teal 200)
- **文字颜色**: `#004D40` (Teal 900)

**设计理念**:
- 青色代表清晰、视觉和感知
- 与相机、图像处理相关
- 冷色调表达精确性

#### 🔶 第 4 层：运动控制层
- **主色**: `#FFF3E0` (Orange 50)
- **边框**: `#EF6C00` (Orange 700)
- **模块填充**: `#FFE0B2` (Orange 200)
- **文字颜色**: `#E65100` (Orange 900)

**设计理念**:
- 橙色代表运动、能量和动态
- 暖色调体现控制的活跃性
- 高对比度确保关键信息突出

#### ⚙️ 第 5 层：硬件接口层
- **主色**: `#ECEFF1` (Blue Grey 50)
- **边框**: `#546E7A` (Blue Grey 600)
- **模块填充**: `#CFD8DC` (Blue Grey 200)
- **文字颜色**: `#263238` (Blue Grey 900)

**设计理念**:
- 灰色代表基础、稳定和硬件
- 中性色调表达底层的可靠性
- 不抢夺其他层的视觉重点

### 图例配色
- **背景**: `#F5F5F5` (Grey 100)
- **边框**: `#BDBDBD` (Grey 400)
- **标题**: `#424242` (Grey 800)

---

## 📊 布局设计

### 整体布局

```
┌────────────────────────────────────────────────┐
│               标题 + 图例                        │
├────────────────────────────────────────────────┤
│                                                │
│          第 1 层：用户交互层 (高 160px)           │
│    [模块1] [模块2] [模块3] [模块4] [模块5]        │
│                                                │
├────────────────────────────────────────────────┤
│          第 2 层：AI 处理层 (高 180px)           │
│    [模块1] [模块2] [模块3] [模块4] [模块5]        │
│                                                │
├────────────────────────────────────────────────┤
│          第 3 层：视觉处理层 (高 200px)          │
│    [模块1] [模块2] [模块3] [模块4] [模块5]        │
│                                                │
├────────────────────────────────────────────────┤
│          第 4 层：运动控制层 (高 220px)          │
│    [模块1] [模块2] [模块3] [模块4] [模块5]        │
│                                                │
├────────────────────────────────────────────────┤
│          第 5 层：硬件接口层 (高 160px)          │
│    [模块1] [模块2] [模块3] [模块4] [模块5]        │
│                                                │
└────────────────────────────────────────────────┘
```

### 尺寸规范

#### 画布尺寸
- **宽度**: 1920px (适合全屏显示)
- **高度**: 1200px (可滚动查看)
- **边距**: 40px (左右边距)

#### 图例尺寸
- **位置**: 左上角 (40, 80)
- **尺寸**: 200 × 240px
- **内容**: 5个层次色块示例

#### 标题尺寸
- **位置**: 顶部居中 (660, 20)
- **尺寸**: 600 × 40px
- **字体**: 24pt 粗体

#### 层背景尺寸
- **X 坐标**: 280px (图例右侧留空)
- **宽度**: 1560px (右侧留边距)
- **高度**: 根据内容调整
  - 层 1: 160px
  - 层 2: 180px
  - 层 3: 200px
  - 层 4: 220px
  - 层 5: 160px

#### 模块尺寸
- **标准宽度**: 200-260px
- **标准高度**: 90-150px
- **圆角半径**: 10px
- **边框粗细**: 2px

### 间距规范

#### 水平间距
- **层内模块间距**: 40px
- **模块到层边缘**: 20px

#### 垂直间距
- **层与层间距**: 40px
- **标题到第一层**: 40px

### 模块内部排版

```
┌──────────────────────────┐
│ <b>模块标题</b>          │ ← 粗体，顶部对齐
│                          │
│ 文件: filename.py        │ ← 文件信息
│                          │
│ 主要内容:                │ ← 左对齐
│ • 项目 1                 │
│ • 项目 2                 │
│ • 项目 3                 │
│                          │
│ 参数配置:                │ ← 配置信息
│ • param1: value         │
│ • param2: value         │
└──────────────────────────┘
```

- **内边距**: 8px
- **行间距**: 1.2
- **字体大小**: 11pt
- **标题字体**: 粗体
- **对齐方式**: 左对齐，顶部对齐

---

## 🔗 连线设计

### 连线类型

#### 1. 主数据流（实线）
- **样式**: 实线
- **粗细**: 3px
- **箭头**: 双向（↔）或单向（→）
- **颜色**: 与起始层颜色一致

**用途**: 主要的数据流和控制流

#### 2. 内部数据流（虚线）
- **样式**: 虚线
- **粗细**: 2px
- **箭头**: 单向（→）
- **颜色**: 与所在层颜色一致

**用途**: 层内模块之间的数据传递

### 连线路径优化

#### 原则
1. **正交路由**: 使用水平+垂直的路径
2. **避免遮挡**: 从模块边缘的空白处引出
3. **最小转折**: 尽量减少转折点数量
4. **统一方向**: 数据流向从上到下为主

#### 路径示例

```
用户层
  │
  ↓ (垂直向下)
  │
AI层 → (水平右移) → 视觉层
  │                    ↓
  ↓                (垂直向下)
控制层 ← (水平左移) ← ↓
  │
  ↓
硬件层
```

### 连线标签

- **位置**: 连线中点
- **背景**: 与起始层颜色相同的浅色背景
- **文字**: 与起始层相同的深色文字
- **字体**: 10pt (比模块文字小)
- **样式**: 粗体
- **圆角**: 小圆角矩形背景

**标签内容示例**:
- "UDP 命令\n5001/5002"
- "图像识别\n请求/结果"
- "3D 位置\n坐标 (mm)"

---

## 📝 文字规范

### 字体选择
- **中文**: 系统默认 (Helvetica/Arial/微软雅黑)
- **英文**: Sans-serif
- **代码**: Monospace

### 字号层级

| 元素 | 字号 | 样式 | 用途 |
|------|------|------|------|
| 主标题 | 24pt | 粗体 | 架构图标题 |
| 层标题 | 18pt | 粗体 | 层次名称 |
| 图例标题 | 16pt | 粗体 | 图例说明 |
| 模块标题 | 11pt | 粗体 | 模块名称 |
| 模块内容 | 11pt | 常规 | 详细信息 |
| 连线标签 | 10pt | 粗体 | 数据流说明 |
| 图例项目 | 11pt | 常规 | 图例色块 |

### 文字颜色对比度

所有文字颜色都经过对比度优化，确保 WCAG AA 标准（对比度 ≥ 4.5:1）

| 背景色 | 文字颜色 | 对比度 | 可读性 |
|--------|---------|--------|--------|
| `#E3F2FD` | `#0D47A1` | 8.2:1 | ✅ 优秀 |
| `#E8EAF6` | `#311B92` | 9.1:1 | ✅ 优秀 |
| `#E0F2F1` | `#004D40` | 8.5:1 | ✅ 优秀 |
| `#FFF3E0` | `#E65100` | 5.2:1 | ✅ 良好 |
| `#ECEFF1` | `#263238` | 10.3:1 | ✅ 优秀 |

---

## 🎯 关键标注说明

### 文件名标注
格式: `文件: filename.py` 或 `文件: filename.py (大小)`

示例:
- `文件: gemini.py`
- `文件: headless_commander.py (161KB)`
- `文件: robot_api.py (57KB)`

### 函数标注
格式: 使用项目符号列表

示例:
```
主要函数:
• move_robot_joints()
• move_robot_pose()
• smooth_circle()
```

### 参数标注
格式: `参数名: 值` 或 `• 参数名: 值`

示例:
```
配置:
• SERVER_IP: 127.0.0.1
• SERVER_PORT: 5001
• 分辨率: 640×480
```

### 数据结构标注
使用缩进和项目符号

示例:
```
输出:
• bbox: [x1,y1,x2,y2]
• label: 类别名称
• confidence: 0-1
```

---

## 📐 模块详细设计

### 模块分组

每一层的模块按功能分组排列：

#### 第 1 层：用户交互层 (5 个模块)
1. 自然语言输入
2. Python API 编程
3. Jupyter Notebook
4. UDP 客户端
5. 配置管理

#### 第 2 层：AI 处理层 (5 个模块)
1. Gemini Live API
2. 自然语言理解
3. 任务规划
4. 视觉识别
5. 工具函数调用

#### 第 3 层：视觉处理层 (5 个模块)
1. 相机控制
2. 物体检测
3. 3D 定位
4. 手眼标定
5. 可达性分析

#### 第 4 层：运动控制层 (5 个模块)
1. UDP 服务器
2. 逆运动学求解
3. 轨迹规划
4. 速度控制
5. 命令队列

#### 第 5 层：硬件接口层 (6 个模块)
1. PAROL6 机械臂
2. 电动夹爪
3. 气动夹爪
4. 串口通信
5. I/O 端口
6. 急停系统

### 模块内容层次

每个模块包含 3-5 个信息层次：

1. **标题** (必需) - 模块名称
2. **文件信息** (可选) - 相关文件名和大小
3. **主要内容** (必需) - 功能、方法、类等
4. **配置参数** (可选) - 关键配置信息
5. **特性说明** (可选) - 特点、精度等

---

## 🔄 数据流说明

### 主要数据流路径

#### 路径 1：自然语言控制流
```
用户输入 (第1层)
  → Gemini AI (第2层)
  → 任务规划 (第2层)
  → 工具调用 (第2层)
  → UDP 服务器 (第4层)
  → 串口通信 (第5层)
  → 机械臂 (第5层)
```

#### 路径 2：视觉引导流
```
相机 (第3层)
  → 物体检测 (第3层)
  → 3D 定位 (第3层)
  → 逆运动学 (第4层)
  → 轨迹规划 (第4层)
  → 速度控制 (第4层)
  → 串口通信 (第5层)
  → 机械臂 (第5层)
```

#### 路径 3：API 控制流
```
Python API (第1层)
  → UDP 客户端 (第1层)
  → UDP 服务器 (第4层)
  → 命令队列 (第4层)
  → 串口通信 (第5层)
  → 机械臂 (第5层)
```

---

## 🛠️ 使用说明

### 如何打开

1. **使用 draw.io 桌面应用**:
   - 下载: https://github.com/jgraph/drawio-desktop/releases
   - 打开文件: `PAROL6项目架构图.drawio`

2. **使用在线版本**:
   - 访问: https://app.diagrams.net/
   - File → Open → 选择 `PAROL6项目架构图.drawio`

3. **在 VS Code 中打开**:
   - 安装插件: "Draw.io Integration"
   - 直接打开 `.drawio` 文件

### 如何编辑

#### 修改模块内容
1. 双击模块
2. 编辑文本内容
3. 保持 HTML 格式标签 (`<b>`, `<br>`)
4. 点击空白处保存

#### 调整模块位置
1. 选中模块
2. 拖动到新位置
3. 使用网格对齐 (Grid: 10px)

#### 修改连线
1. 选中连线
2. 拖动控制点调整路径
3. 编辑标签文字
4. 调整箭头类型

#### 更改颜色
1. 选中元素
2. 右侧面板 → Format
3. Fill (填充色) / Stroke (边框色)
4. 使用本文档中的标准色值

### 导出格式

#### 推荐导出格式
- **PNG**: 高分辨率展示
  - 设置: 300 DPI, 背景白色
  - 用途: 文档、演示

- **SVG**: 矢量图
  - 设置: 嵌入字体
  - 用途: 网页、缩放展示

- **PDF**: 打印
  - 设置: A3 横向
  - 用途: 打印、分享

#### 导出步骤
1. File → Export as
2. 选择格式
3. 设置选项
4. 导出保存

---

## 📱 响应式适配

### 不同显示设备

| 设备 | 屏幕尺寸 | 显示方式 | 建议 |
|------|---------|---------|------|
| 桌面显示器 | 1920×1080+ | 全屏显示 | ✅ 原生尺寸 |
| 笔记本 | 1366×768 | 缩放显示 | 75% 缩放 |
| 平板 | 1024×768 | 滚动查看 | 导出 PDF |
| 手机 | <768px | 不推荐 | 导出分层图片 |

### 打印适配
- **推荐纸张**: A3 (297×420mm) 横向
- **缩放比例**: 适应页面
- **边距**: 10mm
- **色彩模式**: RGB 或 CMYK

---

## 🎨 设计最佳实践

### ✅ 做到这些
1. **保持一致性** - 使用统一的颜色和字体
2. **清晰标注** - 所有模块都有明确的文件名和功能说明
3. **合理间距** - 避免模块过于拥挤
4. **优化连线** - 路径清晰，避免交叉和遮挡
5. **信息层次** - 重要信息使用粗体突出

### ❌ 避免这些
1. **使用白色文字** - 可读性差
2. **模块重叠** - 影响阅读
3. **连线交叉** - 造成混乱
4. **过多颜色** - 分散注意力
5. **信息过载** - 一个模块内容过多

---

## 📚 参考资源

### 设计规范
- Material Design Color System: https://material.io/design/color/
- WCAG 对比度标准: https://www.w3.org/WAI/WCAG21/Understanding/contrast-minimum.html

### 工具
- Draw.io 文档: https://drawio-app.com/doc/
- 配色工具: https://coolors.co/
- 对比度检查: https://webaim.org/resources/contrastchecker/

---

## 🔄 版本历史

### v1.0 (2024-11-20)
- ✅ 初始版本
- ✅ 5 层架构设计
- ✅ 30+ 详细模块
- ✅ 技术感配色方案
- ✅ 优化的布局和连线
- ✅ 详细的文件和函数标注

---

**设计者**: Claude AI Assistant
**项目**: PAROL6 机械臂智能控制系统
**日期**: 2024-11-20
